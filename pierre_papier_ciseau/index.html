<!doctype html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    
    
    <title>Jeux Pierre Papier Ciseau</title>
</head>
<body>
<h1 class="titre" align="center">Pierre Papier & Ciseau</h1>
<div class="choice-container">
    <button class="choice" onclick="jouer('pierre')"><img src="images/pierre.png" alt=""></button>
    <button class="choice" onclick="jouer('papier')"><img src="images/papier.png" alt=""></button>
    <button class="choice" onclick="jouer('ciseau')"><img src="images/ciseau.png" alt=""></button>
</div>
<h3 class="resultat"></h3>
<div class="resultat-detail">

</div>
<p class="detail-points"></p>
<div class="reset-btn-container">
    <button class="reset-data" onclick="resetdata()">Recommencer</button>
</div>

<script>
    var points = localStorage.getItem('ppcData') == null ? {'victoire':0, 'defaite':0, 'nulle':0} : JSON.parse(localStorage.getItem('ppcData'));

    const resultatElt = document.body.querySelector('.resultat');
    const resultatDetailElt = document.body.querySelector('.resultat-detail');
    const resultatPointsElt = document.body.querySelector('.detail-points');

    function jouer(choix_humain){
        console.log(localStorage.getItem('ppcData')!= null);

        const choixOrdi = getChoixOrdi();
        let resultat;

        console.log(choix_humain, choixOrdi);
        if(choix_humain === choixOrdi){
            resultat = 'null';
        }
        else if(
            (choix_humain === 'pierre' && choixOrdi === 'ciseau') ||
            (choix_humain === 'papier' && choixOrdi === 'pierre') ||
            (choix_humain === 'ciseau' && choixOrdi === 'papier')
        ){
            resultat = 'victoire';
        }else{
            resultat = 'defaite';
        }

        //affichage

        if(resultat === 'victoire'){
            resultatElt.innerHTML = 'Victoire ! ðŸ¥³';
            points.victoire += 1;
        }else if(resultat === 'defaite'){
            resultatElt.innerHTML = 'Defaite ðŸ˜­';
            points.defaite += 1;
        }else{
            resultatElt.innerHTML = 'EgalitÃ© ðŸ¤“';
            points.nulle += 1;
        }

        resultatDetailElt.innerHTML = `
        Vous avez choisis: <img class="the_choice_img" src="images/${choix_humain}.png" alt="">
        L'ordinateur a choisis: <img class="the_choice_img" src="images/${choixOrdi}.png" alt="">
        `;

        afficherPoints();
        //save data to local storage
        localStorage.setItem('ppcData', JSON.stringify(points))
        console.log(resultat);
    }
    function getChoixOrdi(){
        const randChoiceNum = Number((Math.random()*100));
        console.log(randChoiceNum);
        let ordiChoice = 'pierre';
        if(randChoiceNum > 100/3 && randChoiceNum <= 100*2/3){
            ordiChoice = 'papier';
        }else if(randChoiceNum > 100*2/3 && randChoiceNum <= 100){
            ordiChoice = 'ciseau';
        }
        return ordiChoice;
    }
    function resetdata(){
        localStorage.removeItem('ppcData');
        const resultatPointsElt = document.body.querySelector('.detail-points');
        resultatPointsElt.innerHTML = `Victoires: 0 | Defaites: 0 | Nulles: 0`
    }
    function afficherPoints(){
        resultatPointsElt.innerHTML = `
        Victoires: ${points.victoire} | Defaites: ${points.defaite} | Nulles: ${points.nulle}
        `;
    }

    afficherPoints();


</script>

</body>
</html>